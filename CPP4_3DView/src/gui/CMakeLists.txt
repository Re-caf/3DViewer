cmake_minimum_required(VERSION 3.11)
project(GUI LANGUAGES CXX)

# –í–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é moc, rcc, uic
set(CMAKE_AUTOUIC ON)
set(CMAKE_AUTOMOC ON)
set(CMAKE_AUTORCC ON)

# –£–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç C++
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# –ü–æ–¥–∫–ª—é—á–∞–µ–º –º–æ–¥—É–ª–∏ Qt6
find_package(Qt6 REQUIRED COMPONENTS Core Widgets OpenGL OpenGLWidgets)

# –£–∫–∞–∑—ã–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
set(SRC_FILES
    mainwindow.cpp
    main.cpp
    openglimpl.cpp
    s21_ProgramSettings.cpp
    gifimage/qgifimage.cpp
)

set(UI_FILES
    mainwindow.ui
)

set(HEADER_FILES
    mainwindow.h
    openglimpl.h
    s21_ProgramSettings.hh
    gifimage/qgifimage.h
)

# –°–æ–∑–¥–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
add_executable(gui
    ${SRC_FILES}
    ${UI_FILES}
)

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ Qt
target_include_directories(gui PRIVATE ${CMAKE_CURRENT_SOURCE_DIR})

# –õ–∏–Ω–∫–æ–≤–∫–∞ —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ Qt6
target_link_libraries(gui PRIVATE
    Qt6::Core
    Qt6::Widgets
    Qt6::OpenGLWidgets
)

# –õ–∏–Ω–∫–æ–≤–∫–∞ —Å OpenGL
if (APPLE)
    find_library(OpenGL_LIBRARY OpenGL)
    target_link_libraries(gui PRIVATE ${OpenGL_LIBRARY})
else()
    find_package(OpenGL REQUIRED)
    target_link_libraries(gui PRIVATE OpenGL::GL)
endif()

# –õ–∏–Ω–∫–æ–≤–∫–∞ —Å –≤–Ω–µ—à–Ω–µ–π –º–æ–¥–µ–ª—å—é
target_link_libraries(gui PRIVATE model)

# üîó –õ–∏–Ω–∫–æ–≤–∫–∞ —Å giflib
find_path(GIF_INCLUDE_DIR gif_lib.h)
find_library(GIF_LIBRARY gif)

if (GIF_INCLUDE_DIR AND GIF_LIBRARY)
    target_include_directories(gui PRIVATE ${GIF_INCLUDE_DIR})
    target_link_libraries(gui PRIVATE ${GIF_LIBRARY})
else()
    message(FATAL_ERROR "giflib not found. Please install libgif-dev")
endif()
